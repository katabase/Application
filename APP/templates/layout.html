<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
              integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <link rel="stylesheet" href="/static/css/styles.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
        <title>{% block title %}{% endblock %}</title>
    </head>
    <body>
        <header>
            <nav class="navbar navbar-light header">
                <a class="navbar-brand" href="{{ url_for('home') }}">KATABASE</a>
                <a class="navbar-brand" href="{{ url_for('index') }}">Index</a>
                <a class="navbar-brand" href="{{ url_for('search') }}">Search</a>
                <a class="navbar-brand" href="{{ url_for('about_us') }}">About us</a>
                <a class="navbar-brand" href="{{ url_for('publications') }}">Publications</a>
            </nav>
        </header>
        <div id="corps">
            {% block corps %}{% endblock %}
        </div>
        {% include "partials/footer.html" %}
    </body>
    <!-- javascript -->
    <script type="text/javascript">
      // CHANGE BEHAVIOUR OF #pills-manuscript-tab and #pills-sell-tab

      // defining variables
      const manuscript = document.querySelector("#pills-manuscript-tab");
      const sell = document.querySelector("#pills-sell-tab");

      if (manuscript != null && sell != null){
        // base behaviour of the buttons
        function baseClicks() {
          sell.setAttribute("style", "border: 1px solid; border-color: var(--custom-main1); background-color: var(--custom-main2); color: var(--custom-cream);");
          manuscript.setAttribute("style", "border: 1px solid; border-color: var(--custom-main1); background-color: var(--custom-cream); color: var(--custom-main2);");
        };
        window.onload = baseClicks();

        // when clicking on "View by manuscript"
        function clickManuscript() {
          sell.setAttribute("style", "border: 1px solid; border-color: var(--custom-main1); background-color: var(--custom-cream); color: var(--custom-main2);");
          manuscript.setAttribute("style", "background-color: var(--custom-main2); color: var(--custom-cream);");
        };

        // when clicking on "View by sale"
        function clickSell() {
          manuscript.setAttribute("style", "border: 1px solid; border-color: var(--custom-main1); background-color: var(--custom-cream); color: var(--custom-main2);");
          sell.setAttribute("style", "background-color: var(--custom-main2); color: var(--custom-cream);");
        };
      };

      ////////////////////////////////////////

      // CHANGE FIGURE ON INDEX PAGE

      // defining variables
      const dwn = $("#dwn");  // dropdown
      const dft = $(dwn).children("[value=1]");  // default value: "Total sales per year"
      const ifr = $("#fig iframe");  // iframe

      // if the button exists (if we are on the index page), trigger a javascript event: when the
      // dropdown changes (when another option is selected), load the proper plotly figure
      if (dwn != null) {
        // when the document is loaded, write a function that is triggered
        // when the selected dropdown item changes
        $(document).ready(function() {

          // set dropdown value to default
          $(dwn).val("1");

          $(dwn).change(function() {
            var selected = $(dwn).children("option").filter(":selected").val();   // currently selected option's @value
            var url = new URL(window.location.origin);  // root of the website's url
            var dest = url.href + "fig/IDX_" + selected;  // url pointing to the iframe selected in the dropdown

            /**
            // build the url for the new iframe depending on the type of page we are on: catalogue, index
            if ($(dwn).attr("class").includes("idx")) {
              var dest = url.href + "fig/IDX_" + selected;
            } else if ($(dwn).attr("class").includes("cat")) {
              // extract the catalogue's id from page URL and built a url to include the figure in an iframe
              path = new URL(window.location.href).pathname;  // path to the current catalogue's page
              var cat_id = path.replace("/View/", "");  // current catalogue's id
              var dest = url.href + "fig/" + cat_id + "_" + selected;
            }
            **/

            // update the iframe element with the proper url
            $(ifr).attr("src", dest);
          });
        });
      };
    </script>
</html>