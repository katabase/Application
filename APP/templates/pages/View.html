{% extends "layout.html" %}
{% block title %} View {{ metadata.title }} {% endblock %}
{% block corps %}

<div class="container">
    <div class="text-center">

        <h2>
            {{ metadata.main_title }}
        </h2>

        <h3>
            {% if metadata.num %}
                {{ metadata.title}}, nÂ° {{ metadata.num }}
            {% else %}
                {{ metadata.title}}
            {% endif %}
        </h3>

        <p class="lead">
    {% if metadata.publisher %}

        {% if metadata.pubPlace and metadata.date %}

            Published by {{ metadata.publisher }} in {{ metadata.pubPlace }} on/in {{ metadata.date }}.

        {% elif metadata.pubPlace %}

            Published by {{ metadata.publisher }} in {{ metadata.pubPlace }}.

        {% elif metadata.date %}

            Published by {{ metadata.publisher }} on/in {{ metadata.date }}.

        {% else %}

            Published by {{ metadata.publisher }}.

        {% endif %}

    {% endif %}
        </p>
        <div id="auction">
            <p>
            {% if metadata.auction_date and metadata.auction_place %}

            The auction took place on {{ metadata.auction_date }}, in {{ metadata.auction_place }}

            {% elif metadata.auction_date %}

            The auction took place on {{ metadata.auction_date }}

            {% elif metadata.auction_place %}

            The auction took place in {{ metadata.auction_place }}
            <br/>
            {% endif %}

                {% if metadata.auctioneer|length > 1 %}

                    The auctioneers were
                    {% for auctioneer in metadata.auctioneer[:-1] %}
                        {{ auctioneer }} and
                    {% endfor %}
                    {% for auctioneer in metadata.auctioneer[-1:] %}
                        {{ auctioneer }}.
                    {% endfor %}

                {% elif metadata.auctioneer|length == 1 %}

                    The auctioneer was {{ metadata.auctioneer[0] }}.

                {% endif %}

                {% if metadata.expert|length > 1 %}

                    The expert were
                    {% for expert in metadata.expert[:-1] %}
                        {{ expert }} and
                    {% endfor %}
                    {% for expert in metadata.expert[-1:] %}
                        {{ expert }}.
                    {% endfor %}

                {% elif metadata.expert|length == 1 %}

                    The expert was {{ metadata.expert[0] }}.

                {% endif %}

                {% if metadata.collector|length > 1 %}

                    The collectors were
                    {% for collector in metadata.collector[:-1] %}
                        {{ collector }} and
                    {% endfor %}
                    {% for collector in metadata.collector[-1:] %}
                        {{ collector }}.
                    {% endfor %}

                {% elif metadata.collector|length == 1 %}

                    The collector was {{ metadata.collector[0] }}.

                {% endif %}

            </p>

        </div>

        <div id="witness">

            {% if metadata.witness|length == 1 %}

                <p>A witness is retained in

                {% for witness in metadata.witness %}

                    {% if witness.ms_country %}
                        {{ witness.ms_country }},
                    {% endif %}

                    {% if witness.ms_settlement %}
                        {{ witness.ms_settlement }},
                    {% endif %}

                    {% if witness.ms_institution %}
                        {{ witness.ms_institution }},
                    {% endif %}

                    {% if witness.ms_repository %}
                        {{ witness.ms_repository }},
                    {% endif %}

                    {% if witness.ms_idno %}
                        with the identifier {{ witness.ms_idno }}.
                    {% endif %}

                {% endfor %}
                </p>

            {% elif metadata.witness|length > 1 %}
            <p>
                A first witness is retained in
                {% for witness in metadata.witness[:1] %}

                    {% if witness.ms_country %}
                        {{ witness.ms_country }},
                    {% endif %}

                    {% if witness.ms_settlement %}
                        {{ witness.ms_settlement }},
                    {% endif %}

                    {% if witness.ms_institution %}
                        {{ witness.ms_institution }},
                    {% endif %}

                    {% if witness.ms_repository %}
                        {{ witness.ms_repository }},
                    {% endif %}

                    {% if witness.ms_idno %}
                        with the identifier {{ witness.ms_idno }}.
                    {% endif %}

                {% endfor %}
                <br/>
                An other witness is retained in
                {% for witness in metadata.witness[1:] %}

                    {% if witness.ms_country %}
                        {{ witness.ms_country }},
                    {% endif %}

                    {% if witness.ms_settlement %}
                        {{ witness.ms_settlement }},
                    {% endif %}

                    {% if witness.ms_institution %}
                        {{ witness.ms_institution }},
                    {% endif %}

                    {% if witness.ms_repository %}
                        {{ witness.ms_repository }},
                    {% endif %}

                    {% if witness.ms_idno %}
                        with the identifier {{ witness.ms_idno }}.
                    {% endif %}

                {% endfor %}
            </p>

            {% endif %}

            {% if metadata.ptr|length > 1 %}
                <p>
                    External resources :
                    {% for ptr in metadata.ptr[:-1] %}
                        <a href="{{ ptr.ptr_target}}" target="_blank">{{ ptr.ptr_host}} ({{ ptr.ptr_type}})</a> and
                    {% endfor %}

                    {% for ptr in metadata.ptr[-1:] %}
                        <a href="{{ ptr.ptr_target}}" target="_blank">{{ ptr.ptr_host}} ({{ ptr.ptr_type}})</a>.
                    {% endfor %}
                </p>
            {% elif metadata.ptr|length == 1 %}
                {% for ptr in metadata.ptr %}
                    External resources : <a href="{{ ptr.ptr_target}}" target="_blank">{{ ptr.ptr_host}} ({{ ptr.ptr_type}})</a>.
                {% endfor %}
            {% endif %}
        </div>

    <div id="digital_publication">

    {% if metadata.encoder and metadata.XML_publisher %}

        <p>Catalogue encoded by {{ metadata.encoder }}, {{ metadata.XML_publisher }}.</p>

        {% elif metadata.encoder and metadata.XML_Publisher %}

         <p>Catalogue encoded by {{ metadata.encoder }}, {{ metadata.XML_publisher }}.</p>

        {% elif metadata.encoder %}

        <p>Catalogue encoded by {{ metadata.encoder }}.</p>

    {% endif %}
        <p>
            <a href="https://github.com/katabase/Application/blob/main/APP/data/{{ file }}_tagged.xml" target="_blank">
                XML encoded catalogue available on GitHub.</a>
        </p>

        <small>{% if metadata.licence %}
            {{ metadata.licence}}
        {% endif %}
        </small>
    </div>
        <br/>
    </div>

    <div class="container">

        {% for entry in content %}
        <div>

            <p id="{{ entry.id}}">{{ entry.num }}.
                {% if entry.trait %}
                <b>{{ entry.author }}</b> - {{ entry.trait }}
                {% else %}
                <b>{{ entry.author }}</b>
                {% endif %}
            </p>
                {% for desc in entry.desc %}
                    <p>- {{ desc.text }}</p>
                {% endfor %}
            <p class="font-italic">{{ entry.note }}</p>
            <p class="text-right">{{ entry.price }}</p>
            <hr/>
        </div>

        {% endfor %}

    </div>
</div>
{% endblock %}